<?xml version="1.0" encoding="UTF-8"?>
<extensionAttribute>
    <displayName>OS - Verify Time Server</displayName>
    <displayInCategory>Security Reporting</displayInCategory>
    <dataType>string</dataType>
    <description>This attribute verifies that time server that is set in the OS.  The value to be verified will need to be specified when creating this extension attribute.  Example: "time.apple.com" verifies that the time server is set to "time.apple.com".</description>
    <scriptContentsMac>#!/bin/sh
desiredValue="EditFromTemplate_Desired_Value_-_Example:_time.apple.com"
 
result=""
tmpResult="`systemsetup -getnetworktimeserver | awk '{print $4}'`"
if [ "$tmpResult" == "$desiredValue" ]; then
result="true"
else
    result="false"
fi
if [ "$result" == "true" ]; then
echo "&lt;result&gt;Pass ($tmpResult) &lt;/result&gt;"
else
echo "&lt;result&gt;Fail ($tmpResult) &lt;/result&gt;"
fi
    </scriptContentsMac>
</extensionAttribute>
