<?xml version="1.0" encoding="UTF-8"?>
<extensionAttribute>
    <displayName>com.apple.screensaver - Require Password</displayName>
    <displayInCategory>Managed Preferences</displayInCategory>
    <dataType>string</dataType>
    <description>This attribute returns enforcement status of the "Require Password" screensaver setting.  Since the com.apple.screensaver domain only applies to the user space, the managed preferences will be queried for the last user to login.  This extension attribute requires this preference be set using Managed Preferences (MCX).</description>
    <scriptContentsMac>#!/bin/sh
currentUser=`last -1 -t console | awk '{print $1}'`
 
if [ -f "/usr/bin/mcxquery" ]; then
result=`/usr/bin/mcxquery -user "$currentUser" | grep -A 1 -w com.apple.screensaver | tail -1 | awk '{print $5}'`
if [ "$result" == "0" ]; then
    result="False"
elif [ "$result" == "1" ]; then
    result="True"
else
    result="Not set."
fi  
fi
 
echo "&lt;result&gt;$result&lt;/result&gt;"
    </scriptContentsMac>
</extensionAttribute>
