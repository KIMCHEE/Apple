<?xml version="1.0" encoding="UTF-8"?>
<extensionAttribute>
    <displayName>Safari - Automatically Open Files After Download</displayName>
    <displayInCategory>Security Reporting</displayInCategory>
    <dataType>string</dataType>
    <description>This attribute verifies whether or not the "Auto Open Files After Download" Safari setting is enabled.  The value to be verified will need to be specified when creating this extension attribute.  Example: "false" verifies that the setting is disabled.  This extension attribute requires this preference be set using Managed Preferences (MCX).</description>
    <scriptContentsMac>#!/bin/sh
desiredValue="EditFromTemplate_Desired_Value_-_Example:_false"
 
appDomain="com.apple.Safari"
keyName="AutoOpenSafeDownloads"
currentUser=`last -1 -t console | awk '{print $1}'`
result=""
tmpResult="`dscl . mcxread /Users/$currentUser \"$appDomain\" \"$keyName\" |grep Value:| sed 's/Value\: //g'`"
echo $tmpResult
if [ "$tmpResult" == "1" ]; then
result="true"
else
if [ "$tmpResult" == "0" ]; then
    result="false"
else
    if [ "$tmpResult" == "" ]; then
        result="Domain or Key Not Found"
    else
        result="$tmpResult"
    fi
fi
fi
if [ "$result" == "$desiredValue" ]; then
echo "&lt;result&gt;Pass ($result)&lt;/result&gt;"
else
echo "&lt;result&gt;Fail ($result)&lt;/result&gt;"
fi
    </scriptContentsMac>
</extensionAttribute>
